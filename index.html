<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta content="width=device-width, initial-scale=0.5, user-scalable=no" name="viewport">
<title>HTML5</title>
<style>
body{
}
*{
  padding:0;
  margin:0;
}
img{
  display: block;
  position: fixed;
  left: 0;
  top: 0;
  bottom: 0;
  right: 0;
  opacity: .6;
  object-fit: cover;
  object-position: center;
}
canvas {
  display: block;
  cursor: crosshair;
  display: block;
  position: relative;
  z-index: 88888;
}
#text{
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  font-size: 32px;
  line-height: 62px;
  padding: 60px 39px;
  text-align: justify;
  overflow: auto;
  z-index: 99999;
  color: dimgrey;
}
</style>
</head>
<body>
<!-- <img src="img.jpg" alt=""> -->
<canvas id="c"></canvas>
<div id="text"></div>
<script>
window.requestAnimFrame =
  window.requestAnimationFrame ||
  window.webkitRequestAnimationFrame ||
  window.mozRequestAnimationFrame ||
  window.oRequestAnimationFrame ||
  window.msRequestAnimationFrame ||
  function(callback) {
    window.setTimeout(callback, 1000 / 60);
  };
var windW = document.documentElement.clientWidth || document.body.clientWidth,
  windH = document.documentElement.clientHeight || document.body.clientHeight;
  
canvas = document.getElementById('c');
context = canvas.getContext('2d');
  
canvas.width = windW;
canvas.height = windH;
  
originX = windW / 2;
originY = windH;
  
  
var firesBox = firesBoxTmp = [],
  line = 20;
  
var Fireworks = function(px, sx, line, fire, dely) {
  
  this.fire = fire;
  this.dely = dely;
  this.endX = px.x;
  this.endY = px.y;
  
  this.startX = sx.x;
  this.startY = sx.y;
  
  this.p1 = {
    x: sx.x,
    y: sx.y
  };
  var totallong = Math.sqrt((this.endX - this.p1.x) * (this.endX - this.p1.x) + (this.endY - this.p1.y) * (this.endY - this.p1.y));
  
  this.p2 = {
    x: (line * (this.endX - this.p1.x)) / totallong + this.p1.x,
    y: (line * (this.endY - this.p1.y)) / totallong + this.p1.y
  }
  
  this.color = {
    r: Math.random() * 360,
    g: Math.random() * 20 + 50,
    b: Math.random() * 20 + 50,
    a: 0.5 + Math.random() * 0.5
  }
}
  
Fireworks.prototype.draw = function() {
  context.beginPath();
  context.moveTo(this.p1.x, this.p1.y);
  context.lineTo(this.p2.x, this.p2.y);
  context.strokeStyle = 'hsla(' + this.color.r + ', ' + this.color.g + '%, ' + this.color.b + '%, ' + this.color.a + ')';
  context.stroke();
  context.closePath();
}
  
Fireworks.prototype.update = function() {
  if (
    (this.endX < this.startX && this.p1.x < this.endX) ||
    (this.endX >= this.startX && this.p1.x >= this.endX)
  ) {
    if (!this.fire) firesBoxTmp.push(this);
    return;
  }
  var dely = this.dely;
  this.p1.x += (this.endX - this.startX) * dely;
  this.p1.y += (this.endY - this.startY) * dely;
  this.p2.x += (this.endX - this.startX) * dely;
  this.p2.y += (this.endY - this.startY) * dely;
  
  this.color.r += 5;
  
  if (
    (this.endX < this.startX && this.p1.x >= this.endX) ||
    (this.endX >= this.startX && this.p1.x <= this.endX)
  ) {
    firesBoxTmp.push(this);
  } else {
    firesBoxTmp.push(this);
    if (!this.fire) {
      firesBoxTmp.push(this);
      return;
    }
    var startP = {},
      endP = {};
  
    startP.x = this.endX;
    startP.y = this.endY;
  
    for (var i = 1; i < 10; i++) {
      if (i != 5) {
        r = Math.random() * 10;
        endP.x = startP.x + Math.sin(2 * Math.PI * i * 36 / 360) * r;
        endP.y = startP.y - Math.cos(2 * Math.PI * i * 36 / 360) * r;
        fire = new Fireworks(endP, startP, Math.random() * line * .5, false, .013);
        firesBoxTmp.push(fire);
      }
  
    }
  }
}
  
function update() {
  requestAnimFrame(update);
  context.clearRect(0, 0, canvas.width, canvas.height);
  var i = firesBox.length;
  if (i <= 0) return;
  while (i--) {
    firesBox[i].draw();
    firesBox[i].update();
  }
  firesBox = firesBoxTmp;
  firesBoxTmp = [];
  
}
  
function heartShape() {
  if (heartindex >= 4.8) {
    clearTimeout(heart);
  }
  var endP = {},
    startP = {},
    r = 90,
    dx = windW / 2,
    dy = windH / 3;
  
  startP.x = originX;
  startP.y = originY;
  
  var m, n, x, y, i = heartindex;
  
  m = i;
  n=-r*(((Math.sin(i)*Math.sqrt(Math.abs(Math.cos(i))))/(Math.sin(i)+1.4))-2*Math.sin(i)+2);
  endP.x = n * Math.cos(m) + dx;
  endP.y = n * Math.sin(m) + dy;
  fire = new Fireworks(endP, startP, line, true, 0.016);
  firesBox.push(fire);
  heartindex += .04;
  
}
var heartindex = -1.56;
var heart = setInterval(function() {
  heartShape();
}, 10);
window.onload = update;
heartShape();
</script>
<script>
  let divTyping = document.getElementById('text')
  let i = 0,
    timer = 0,
    str = 'n宝贝徒儿：n七号见你那晚依然还会像放电影一样在脑海里一帧一帧的回映，我也不知道从何时开始心动，可能见你第一眼开始，这个漫长的故事就已经开始抒写了。n每个人的脑海里都会有一个梦吧，或深或浅，也许你能精准把握，也许你对它茫然无知，但那一定是美好的，那是你对未来的寄托，也是你曾经遇到的所有美好织接而成的那一道心里的彩虹，在遇到你之前，我也抓不住它，遇到了你之后，我彷佛知道了它在哪里！n我不确定我们是从什么时候开始交往的，七号八号或者是九号，不过我更喜欢九号，那是我的幸运数字。算起来短短不到一个月的时间，却像是在我心里跑了好久好久，久到彷佛我们上辈子就认识，久到彷佛我有了灵智，你就一直在我身边是我最亲近的人，我想我们是被彼此吸引着，才会让彼此靠的越来越近吧。n记得你上次问我，爱会消失的对吗，我不知道是否真的有灵魂，如果有，百年之后我会带着对你的爱去往另一个世界，如果没有，那可能就与我一同葬于地下了。我记得你问我是否相信会有来世，其实之前我并不相信有来世的，自从遇见了你，我会希望有来世，希望来世也能陪伴你。n我真的感觉自己很幸运，幸运遇到了你。n若人生就像一条河流，而时间只能固定在一个点，我希望上游全是你的影子，下游全是我们的未来。纵使河流弯曲，亦或遇见悬崖峭壁，我想瀑布也会是一道美丽的风景。幸福也是相对的吧，一个没有经历过痛苦和挫折的人哪能知道幸福的可贵。我想和你一起，不管此时的你一帆风顺，还是满路荆棘，我都想和你一起。n在给你写这些话时，对你的思念总是会扰乱我的思绪，让我不知如何向你表达，所以总是一直断断续续。不知不擅表达的我是否能给你带来一点温暖，但我在很认真的写每一个字，每一句话，以及和你走过的每一段旅程。'

var input = ''

  function typing () {
    if (i <= str.length) {
      input = str.slice(0, i++).replace(/n/g,'<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;')
      divTyping.innerHTML = input + '_'
      timer = setTimeout(typing, 130)
      divTyping.scrollTop = divTyping.scrollHeight;
    }
    else {
      divTyping.innerHTML = input//结束打字,移除 _ 光标
      clearTimeout(timer)
    }
  }

  setTimeout(function(){
    typing(); 
  },5000)
</script>
</body>
</html>
